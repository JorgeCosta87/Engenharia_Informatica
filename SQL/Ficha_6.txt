SELECT
  NLIVROS,
  NAUTORES,
  NEDITORAS
FROM
  (
    SELECT
      COUNT(LIVROS.CODIGO_LIVRO) NLIVROS
    FROM
      LIVROS
  )
  ,
  (
    SELECT
      COUNT(AUTORES.CODIGO_AUTOR) NAUTORES
    FROM
      AUTORES
  )
  ,
  (
    SELECT
      COUNT(EDITORAS.CODIGO_EDITORA) NEDITORAS
    FROM
      EDITORAS
  ); 
------------------

SELECT
  COUNT(DISTINCT TITULO)         AS NLIVROS,
  COUNT(DISTINCT A.CODIGO_AUTOR) AS NAUTORES,
  COUNT(DISTINCT CODIGO_EDITORA) AS NEDITORAS
FROM
  LIVROS L,
  AUTORES A
WHERE
  L.CODIGO_AUTOR (+)= A.CODIGO_AUTOR;

-----------------------

SELECT
  'O AUTOR '
  || TAB1.NOME
  || ' ESCREVEU '
  || NLIVROS
  || ' LIVROS E '
  || NLIVROSFCA
  || ' SOB A ALÇADA DA EDITORA '
  || NOME_EDITORA
FROM
  (
    SELECT
      NOME,
      COUNT(*) NLIVROS
    FROM
      LIVROS L,
      AUTORES A
    WHERE
      L.CODIGO_AUTOR = A.CODIGO_AUTOR
    GROUP BY
      NOME
  )
  TAB1,
  (
    SELECT
      A.NOME,
      E.NOME   AS NOME_EDITORA,
      COUNT(*) AS NLIVROSFCA
    FROM
      LIVROS L,
      AUTORES A,
      EDITORAS E
    WHERE
      L.CODIGO_AUTOR     = A.CODIGO_AUTOR
    AND L.CODIGO_EDITORA = E.CODIGO_EDITORA
    AND E.NOME           = 'FCA - EDITORA'
    GROUP BY
      A.NOME,
      E.NOME
  )
  TAB2
WHERE
  TAB1.NOME = TAB2.NOME;
  
---------------------------------------------------

SELECT
  TAB1.NOME,
  TITULO NLIVROS,
  NLIVROSFCA,
  NOME_EDITORA
FROM
  (
    SELECT
      NOME,
      COUNT(*) NLIVROS
    FROM
      LIVROS L,
      AUTORES A
    WHERE
      L.CODIGO_AUTOR = A.CODIGO_AUTOR
    GROUP BY
      NOME
  )
  TAB1,
  (
    SELECT
      A.NOME,
      E.NOME   AS NOME_EDITORA,
      COUNT(*) AS NLIVROSFCA
    FROM
      LIVROS L,
      AUTORES A,
      EDITORAS E
    WHERE
      L.CODIGO_AUTOR     = A.CODIGO_AUTOR
    AND L.CODIGO_EDITORA = E.CODIGO_EDITORA
    AND E.NOME           = 'FCA - EDITORA'
    GROUP BY
      A.NOME,
      E.NOME
  )
  TAB2,
  (
    SELECT
      A.NOME,
      TITULO
    FROM
      LIVROS L,
      AUTORES A,
      EDITORAS E
    WHERE
      L.CODIGO_AUTOR     = A.CODIGO_AUTOR
    AND L.CODIGO_EDITORA = E.CODIGO_EDITORA
    AND E.NOME           = 'FCA - EDITORA'
    AND PRECO_TABELA = ( 
    SELECT MAX(PRECO_TABELA)
    FROM LIVROS L, EDITORAS E
    WHERE L.CODIGO_EDITORA = E.CODIGO_EDITORA
    AND E.NOME = 'FCA - EDITORA')
  ) TAB3
WHERE
  TAB1.NOME   = TAB2.NOME
AND TAB1.NOME = TAB3.NOME;


----------------------------------------------

SELECT GENERO_PREFERIDO
FROM AUTORES;

SELECT CODIGO_AUTOR, COUNT(CODIGO_LIVRO)
FROM LIVROS
WHERE GENERO = ()
GROUP BY CODIGO_AUTOR;
  